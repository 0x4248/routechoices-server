{% extends "kagi/base.html" %}
{% load i18n %}
{% load static %}
{% load compress %}

{% block content %}
{{ block.super }}

<h1>{% trans "TOTP (Authenticator) Devices" %}</h1>
{% if object_list %}
<table class="table">
  <thead>
    <tr>
      <th>{% trans 'Added on' %}</th>
      <th>{% trans 'Last used on' %}</th>
      <th>Delete</th>
    </tr>
  </thead>
  <tbody>
    {% for device in object_list %}
    <tr>
      <td>{{ device.created_at }}</td>
      <td>{% if device.last_used_at %}<span class="date-utc" data-date="{{device.last_used_at|date:'c'}}">{{ device.last_used_at }} UTC</span>{% else %}Never{% endif %}</td>
      <td>
        <form method="post">{% csrf_token %}
          <input name="device_id" type="hidden" value="{{ device.pk }}">
          <input class="btn btn-success" type="submit" name="delete" value="X">
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>
  <i class="fa fa-warning"></i> You do not have any TOTP (Authenticator) device!
</p>
{% endif %}
<a class="btn btn-primary" href="{% url 'kagi:add-totp' %}">{% trans 'Add a TOTP (Authenticator) Device' %}</a>
<p>
<a href="{% url 'kagi:two-factor-settings' %}">{% trans '&larr; Back to settings' %}</a>
</p>
{% endblock %}

{% block extra_body %}
{{ block.super }}
{% compress js %}
<script src="{% static '/vendor/umbrella-3.3.0/umbrella.min.js' %}"></script>
<script src="{% static '/vendor/dayjs-1.10.6/dayjs.min.js' %}"></script>
<script src="{% static '/scripts/dashboard/date_to_local.js' %}"></script>
{% endcompress %}
{% endblock %}
